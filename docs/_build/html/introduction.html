<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Introduction &mdash; Harman Developer 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Harman Developer 1.0 documentation" href="index.html" />
    <link rel="prev" title="Harman HKWirelessHD API Documentation" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="index.html" title="Harman HKWirelessHD API Documentation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Harman Developer 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>The Harman Kardon WirelessHD (HKWirelessHD) SDK is provided for rd party developers to communicate with Harman/Kardon Omni Series and JBL Link Series audio/video devices. The intent of this SDK is to provide the APIs, tools and libraries necessary to build, test and deploy the latest audio applications on your platform.</p>
<p>Currently, three kind of APIs are provided.</p>
<ul class="simple">
<li>iOS APIs and SDK</li>
<li>Android APIs and SDK</li>
<li>Web (REST) APIs</li>
</ul>
<p>This document describes about the REST APIs, and for iOS and Android SDK, you can refer to <a class="reference external" href="http://harmandeveloperdocs.readthedocs.io/en/latest/index.html">Harman developer website</a>.</p>
<div class="section" id="overview-of-hwkhub">
<h2>Overview of HWKHub<a class="headerlink" href="#overview-of-hwkhub" title="Permalink to this headline">¶</a></h2>
<p>HKWHub app is an iOS that that uses HKWirelessHD SDK and acts as a Web Hub that handles HTTP requests to control speakers and stream music. It enables any type of &#8220;connected&#8221; devices (like sensors or smart devices) and cloud-based service to connect HK Omni speakers and stream music.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Please note that HKWHub app is an on-going project, and not yet ready for production. We hope developers play around with this app and implement their own apps or services by integrating many other IoT devices or services and adding intelligence to the Hub app.</p>
<p class="last">Any feedback or request for new APIs and features are always welcome.</p>
</div>
<div class="section" id="use-cases">
<h3>Use Cases<a class="headerlink" href="#use-cases" title="Permalink to this headline">¶</a></h3>
<div class="figure">
<img alt="_images/hub-use-cases.png" src="_images/hub-use-cases.png" />
</div>
</div>
<div class="section" id="hkwhub-app">
<h3>HKWHub App<a class="headerlink" href="#hkwhub-app" title="Permalink to this headline">¶</a></h3>
<p>Web Hub handles all the requests from and response to smart devices, sensors or clouds to control audio playback with wireless speakers in the house.</p>
<div class="section" id="features">
<h4>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h4>
<ul>
<li><dl class="first docutils">
<dt>Supports integration with cloud-based services, smart devices or sensors</dt>
<dd><ul class="first last simple">
<li>Receives the requests from clouds (web service) outside or sensors in the house</li>
<li>Translates the requests into HKWirelessHD commands and controls the speakers based on the requests.</li>
<li>Sends response with status of speakers to the cloud if necessary</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Central Music Playlist manager</dt>
<dd><ul class="first last simple">
<li>Maintain user’s media list from iOS local music library or streaming services, like MixRadio, etc.</li>
<li>Maintain a collection of sound files used for IoT use cases, like door bell, etc.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="usage">
<h4>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>User may place an iOS device on the cradle and run WebHub app. Then the app acts as Web Hub. (A stationary device in a house lik AppleTV can be a nice iOS device for WebHub.)</li>
</ul>
<div class="figure">
<img alt="_images/hub-app.png" src="_images/hub-app.png" />
</div>
</div>
</div>
<div class="section" id="overall-architecture">
<h3>Overall Architecture<a class="headerlink" href="#overall-architecture" title="Permalink to this headline">¶</a></h3>
<p>HKWHub App handles requests from and sends responses to sensors, smart devices or cloud-based services to control audio playback with wireless speakers in the house.</p>
<div class="figure">
<img alt="_images/architecture.png" src="_images/architecture.png" />
</div>
<p>The latest version of HKWHub app supports the following three modes:</p>
<ul>
<li><dl class="first docutils">
<dt>Cloud mode (HKIoTCloud)</dt>
<dd><ul class="first last simple">
<li>HKWHub app communicates with HKIoTCloud to receive speaker control commands by REST API call from 3rd party services or clients.</li>
<li>HKIoTCloud handles the REST API request from any clients in the Internet. The clients can be 3rd party apps or services or devices like smartphone or sensors.</li>
<li>In this mode, any 3rd party services or clients in the Internet can reach out to HKWHub app and then control speakers and playback of audio.</li>
<li>All the 3rd party apps or services should be authorized with OAuth2 to get access token. An access token is required when 3rd party apps call the REST APIs. The detailed information about OAuth2 is available at <a class="reference external" href="http://harmandeveloperdocs.readthedocs.org/en/latest/iOS/hkwhub-spec.html#id2">this link</a>.</li>
</ul>
</dd>
</dl>
</li>
</ul>
<ul>
<li><dl class="first docutils">
<dt>Local Server Mode</dt>
<dd><ul class="first last simple">
<li>HKWHub app lauches a web server internally, and then handles the REST API requests for speaker control and playback from devices, sensors or applications in the same local network.</li>
<li>HKWHub app opens a HTTP port in the local network, so if devices or services outside of the local network want to reach out to HKWHub (and then speakers) then user needs to configure the route so that a request coming from outside can be routed to HKWHub app accordingly, such as firewall, etc.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub Cloud mode</dt>
<dd><ul class="first last simple">
<li>HKWHub app uses PubNub API/SDK to connect to PubNub server and communicate with it to receive commands from other PubNub clients, and also sends events to other PubNub client, through a common PubNub channel.</li>
<li>By setting the same PubNub channel, any client devices or services can communicate with the HKWHub app, and then control speakers and playback of audio.</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>The following figure shows how HKWHub app handles three modes.</p>
<div class="figure">
<img alt="_images/HubAppV2.png" src="_images/HubAppV2.png" />
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="quick-getting-started-guide-to-hkwhub-app">
<h2>Quick Getting Started Guide to HKWHub App<a class="headerlink" href="#quick-getting-started-guide-to-hkwhub-app" title="Permalink to this headline">¶</a></h2>
<div class="section" id="overview-of-hkwhubapp">
<h3>Overview of HKWHubApp<a class="headerlink" href="#overview-of-hkwhubapp" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can download the HKWHub app from App Store (<a class="reference external" href="https://itunes.apple.com/us/app/hk-whub-app/id1057062847?ls=1&amp;mt=8">click here</a>)</p>
</div>
<div class="section" id="main-screen">
<h4>Main Screen<a class="headerlink" href="#main-screen" title="Permalink to this headline">¶</a></h4>
<div class="figure">
<a class="reference internal image-reference" href="_images/hubappv2-main.jpg"><img alt="_images/hubappv2-main.jpg" src="_images/hubappv2-main.jpg" /></a>
</div>
<p>The main screen is composed of two parts - <strong>Select Server mode</strong> (amonng HKIoTCloud, Local Server and PubNub Cloud), and <strong>Settings</strong>.</p>
<p>The <strong>Select Server mode</strong> has three options:</p>
<ul>
<li><dl class="first docutils">
<dt>Connect to HK IoT Cloud</dt>
<dd><ul class="first last simple">
<li>HKWHub app connects to HKIotCloud, and communicate with it with WebSocket to receive REST API commands from and send the responses back to the Cloud.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Run Local Web Server</dt>
<dd><ul class="first last simple">
<li>HKWHub app runs a local web server and processes incoming REST requests to control speakers and playback of audio</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Connect to PubNub Cloud</dt>
<dd><ul class="first last simple">
<li>HKWHub app uses PubNub APIs to connect PubNub server and communicate with other PubNub client through a common channel.</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>The <strong>Settings</strong> menu has four sub menus:</p>
<ul>
<li><dl class="first docutils">
<dt>Media List</dt>
<dd><ul class="first simple">
<li>User can maintain the list of audio files for audio playback.</li>
<li>User can add audio from iOS Media Library.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that only the media file available offline and not from Apple Musica can be added. The music file that came from Apple Music cannot be added by DRM issue.</p>
</div>
<div class="last figure">
<a class="reference internal image-reference" href="_images/hubappv2-medialist.jpg"><img alt="_images/hubappv2-medialist.jpg" src="_images/hubappv2-medialist.jpg" /></a>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Set API Keys</dt>
<dd><ul class="first simple">
<li>To use PubNub mode, user needs to enter PubNub API keys. It requires Publish Key and Subscribe Key. And also, user needs to set the channel where it exchanges the command and events with other clients.</li>
<li>If user (or developer) wants to use TTS APIs such as <strong>play_tts</strong>, then user needs to enter VoiceRSS (<a class="reference external" href="http://www.voicerss.org">http://www.voicerss.org</a>) API keys. You can get a free API key.</li>
</ul>
<div class="last figure">
<a class="reference internal image-reference" href="_images/hubappv2-apikeys.jpg"><img alt="_images/hubappv2-apikeys.jpg" src="_images/hubappv2-apikeys.jpg" /></a>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Speaker List</dt>
<dd><ul class="first simple">
<li>You can see the list of speakers available in the current local network.</li>
<li>You can also change the device name or group name from this screen.</li>
</ul>
<div class="last figure">
<a class="reference internal image-reference" href="_images/hubappv2-speakers.jpg"><img alt="_images/hubappv2-speakers.jpg" src="_images/hubappv2-speakers.jpg" /></a>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>About</dt>
<dd><ul class="first last simple">
<li>The information of the app and the links to Harman developer documentation site.</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>From now on, we will explain a little more detail about each server mode.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="hkiotcloud-mode">
<h3>HKIoTCloud Mode<a class="headerlink" href="#hkiotcloud-mode" title="Permalink to this headline">¶</a></h3>
<div class="section" id="connecting-to-hkiotcloud">
<h4>Connecting to HKIoTCloud<a class="headerlink" href="#connecting-to-hkiotcloud" title="Permalink to this headline">¶</a></h4>
<p>In HKIoTCloud demo, 3rd party clients can connect to HKIoTCloud (<a class="reference external" href="http://hkiotcloud.herokuapp.com">http://hkiotcloud.herokuapp.com</a>) and send REST requests to control speakers and play audio. In order to use HKIoTCloud mode, user needs to sign up to the cloud with username, emaill address and password. Once sign up is done, user need to sign in to the server. User sign-up and sign-in can be done within the HKWHub app, as shown below.</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/hubappv2-signin.jpg"><img alt="_images/hubappv2-signin.jpg" src="_images/hubappv2-signin.jpg" /></a>
</div>
<p>Once the HKWHub app successfully signs in to HKIoTCloud, the screen will be switched to Log screen, like shown as below. You can see all the message logs received from or sent to the cloud. Each log contains a JSON data, so you can see what information is being sent and received between the server.</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/hubappv2-afterlogin.jpg"><img alt="_images/hubappv2-afterlogin.jpg" src="_images/hubappv2-afterlogin.jpg" /></a>
</div>
<p>If you want to disconnect the server and return to the main screen, press <strong>Disconnect</strong> button on the top righthand corner.</p>
</div>
<div class="section" id="sending-rest-requests-to-hkiotcloud">
<h4>Sending REST Requests to HKIoTCloud<a class="headerlink" href="#sending-rest-requests-to-hkiotcloud" title="Permalink to this headline">¶</a></h4>
<p>Once the HKWHub App is running, you can now connect a client to HKIoTCloud and send REST requests to the server. We will explain about the REST APIs supported with a little more detailed example of <strong>curl</strong> commands in the next section.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For a client to connect to HKIoTCloud, the same username and password are required.</p>
</div>
<p>As an example of client, HKIoTCloud hosts a Web-based client app, at <a class="reference external" href="http://hkiotcloud.herokuapp.com/webapp/">http://hkiotcloud.herokuapp.com/webapp/</a>. The following is a screenshot of the web app.</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/cloudapp-login.png"><img alt="_images/cloudapp-login.png" src="_images/cloudapp-login.png" /></a>
</div>
<p>Once user authentication is done successfully, the Web app will switch the screen to the Playlist screen.</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/cloudapp-medialist.png"><img alt="_images/cloudapp-medialist.png" src="_images/cloudapp-medialist.png" /></a>
</div>
<p>Now, you can click one of the titles in the list, and see how the web app is playing the title, showing the information of the title, volume, and playback time, and so on.</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/cloudapp-mediaplayer.png"><img alt="_images/cloudapp-mediaplayer.png" src="_images/cloudapp-mediaplayer.png" /></a>
</div>
<p>If you click <strong>Speaker List</strong> menu on the left, you can see more detailed information of speakers like below, and can control speakers, like remove a speaker from the current playback session or add a speaker to playback.</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/cloudapp-speakers.png"><img alt="_images/cloudapp-speakers.png" src="_images/cloudapp-speakers.png" /></a>
</div>
</div>
</div>
<div class="section" id="local-server-mode">
<h3>Local Server Mode<a class="headerlink" href="#local-server-mode" title="Permalink to this headline">¶</a></h3>
<div class="section" id="running-local-server">
<h4>Running Local Server<a class="headerlink" href="#running-local-server" title="Permalink to this headline">¶</a></h4>
<p>Loca Server Mode is almost the same as HKIoTCloud, except that HKWHub app runs a web server inside, instead connecting to HKIoTCloud. Therefore, HKWHub app can receive REST requests directly from clients in the same network. If you want to connect speakers from any type of devices in the same local network, then Local Server mode can be easier solution.</p>
<p>Once you click <strong>Run Local Web Server</strong> menu, then you will see the following screen. From the screen, you can see a URL indicating where a client should connect to. In this example, the client should enter the URL <strong>http://10.0.1.37:8080/</strong>  followed by REST command and parameters.</p>
<p>The RESI APIs are almost the same as the ones of HKIoTCloud mode.</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/hubappv2-localserver.jpg"><img alt="_images/hubappv2-localserver.jpg" src="_images/hubappv2-localserver.jpg" /></a>
</div>
</div>
<div class="section" id="sending-rest-requests-to-localserver">
<h4>Sending REST Requests to LocalServer<a class="headerlink" href="#sending-rest-requests-to-localserver" title="Permalink to this headline">¶</a></h4>
<p>As a sample client app, you can use <strong>WebHubWebApp</strong> that you can download from Harman Developer web site (<a class="reference external" href="http://developer.harman.com">http://developer.harman.com</a>) or direclty from <code class="xref download docutils literal"><span class="pre">here</span></code>. The Web app is created using Polymer v0.5 (<a class="reference external" href="https://www.polymer-project.org/0.5/">https://www.polymer-project.org/0.5/</a>).</p>
<p>Once you download the app, unzip it. You will see the following sub directories.</p>
<ul class="simple">
<li>bower_components: THis is the folder where polymer libraries are located.</li>
<li>hkwhub: this is the folder containing the WebHubApp source code.</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span class="nv">$ </span><span class="nb">cd </span>WebHubWebApp
<span class="nv">$ </span>python -m SimpleHTTPServer
</pre></div>
</div>
<p>You will get some log messages like &#8220;Serving HTTP on 0.0.0.0 port 8000 ...&#8221;</p>
<p>Next, launch your web browser (Chrome, Safari, ...) and go to <a class="reference external" href="http://localhost:8000/hkwhub/">http://localhost:8000/hkwhub/</a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Your iOS device running HKWHub app and your Desktop PC running web browser should be in the same network.</p>
</div>
<p>At the fist screen looking like this:</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/webapp-initial.png"><img alt="_images/webapp-initial.png" src="_images/webapp-initial.png" /></a>
</div>
<p>Enter the URL that the HKWHub app says: <a class="reference external" href="http://10.0.1.37:8080/">http://10.0.1.37:8080/</a>, like this:</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/webapp-initial-url.png"><img alt="_images/webapp-initial-url.png" src="_images/webapp-initial-url.png" /></a>
</div>
<p>If you press <strong>Submit</strong>, then you will see the first screen like below. This is the list of media items available at the HKWHub app.</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/webapp-afterlogin.png"><img alt="_images/webapp-afterlogin.png" src="_images/webapp-afterlogin.png" /></a>
</div>
<p>The UI of the Web app is exactly the same as HKIoTCloud web app. So, we skip to explain the rest parts of the app.</p>
</div>
</div>
<div class="section" id="pubnub-server-mode">
<h3>PubNub Server Mode<a class="headerlink" href="#pubnub-server-mode" title="Permalink to this headline">¶</a></h3>
<div class="section" id="connect-to-pubnub-server">
<h4>Connect to PubNub Server<a class="headerlink" href="#connect-to-pubnub-server" title="Permalink to this headline">¶</a></h4>
<p>With PubNub server mode, any PubNub client can connect to and control Omni speakes managed by HKWHub app. Just click <strong>Connect to PubNub Cloud</strong> menu in the main screen, then you will see the screen like below. Please check if the logs are saysing something like &#8220;Received: Hello from HKWHubApp&#8221; which is the message sent back from PubNub server after the HKWHub app published the message. This means the app is now connected to PubNub cloud.</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/hubappv2-pubnub.jpg"><img alt="_images/hubappv2-pubnub.jpg" src="_images/hubappv2-pubnub.jpg" /></a>
</div>
<p>Differently from HKIoTCloud or Local Server mode that relies on <strong>REST API</strong> for control and playback of speakers, PubNub is using Publish/Subscribe messaging instead. And in order to route the message among clients, we should set <strong>PubNub Channel</strong> so that all the published messages are correctly routed to subscribed clients of the same channel.</p>
<p>So, for HKWHub app successfully connects to PubNub cloud, user needs to set PubNub <strong>Publish Key</strong>, <strong>Subscribe Key</strong>, and <strong>Channel</strong>. As explained already, user can set these keys in the <strong>Settings/Set API Keys</strong> menu in the main screen.</p>
</div>
<div class="section" id="sending-rest-requests-to-pubnub-cloud">
<h4>Sending REST Requests to PubNub Cloud<a class="headerlink" href="#sending-rest-requests-to-pubnub-cloud" title="Permalink to this headline">¶</a></h4>
<p>Once the HKWHub app is connected to PubNub cloud, a PubNub client can send PubNub message. Even though it does not use REST API, but use PubNub&#8217;s Subscribe/Publish messaging instead, the content of the messages are almost the same as the REST APIs, and it is in JSON format.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">One biggest difference between REST API and Publish/Subscribe messaging is that Pub/Sub messaging does not need to do <strong>Polling</strong> for getting information from the server when an event occurs on the server side, because REST API does not support <strong>callback</strong> mechanism to notify an <strong>event</strong> to clients. However, Pub/Sub messaging is bidirectional, the client can get notified immediately from the server. Either client or server can publish a message to the channel being shared to notify an event to subsribers.</p>
</div>
<p>In this reason, the messages of request and response for speaker control are a littke different. For a client to send a command to speaker, the client <strong>publish</strong> the command to the channel. Then because HKWHub app is one of the clients, it receives the command, and process the command internally. If the command requires a response, then HKWHub app should send the response back to the client. To to that, HKWHub app also needs to <strong>publish</strong> the response to the channel. And, the client will get the response because it subscribed to the channel.</p>
<p>If HKWHub app has some event to report to notify to clients, for example, device status changed, or playback time changed, etc., then HKWHub app publish the events to the channel, then all the client listening to the channel will receive the event.</p>
</div>
<div class="section" id="sample-web-app">
<h4>Sample Web App<a class="headerlink" href="#sample-web-app" title="Permalink to this headline">¶</a></h4>
<p>As a sample client app, you can use <strong>WebHubPubNubApp</strong> that you can download from Harman Developer web site (<a class="reference external" href="http://developer.harman.com">http://developer.harman.com</a>) or directly from <code class="xref download docutils literal"><span class="pre">here</span></code>.. Likewise, The Web app is created using Polymer v0.5 (<a class="reference external" href="https://www.polymer-project.org/0.5/">https://www.polymer-project.org/0.5/</a>).</p>
<p>Once you download the app, unzip it. You will see the following sub directories.</p>
<ul class="simple">
<li>bower_components: THis is the folder where polymer libraries are located.</li>
<li>hkwhub: this is the folder containing the WebHubApp source code.</li>
</ul>
<div class="highlight-shell"><div class="highlight"><pre><span class="nv">$ </span><span class="nb">cd </span>WebHubPubNubApp
<span class="nv">$ </span>python -m SimpleHTTPServer
</pre></div>
</div>
<p>You will get some log messages like &#8220;Serving HTTP on 0.0.0.0 port 8000 ...&#8221;</p>
<p>Next, launch your web browser (Chrome, Safari, ...) and go to <a class="reference external" href="http://localhost:8000/hkwhub/">http://localhost:8000/hkwhub/</a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Your iOS device running HKWHub app and your Desktop PC running web browser should be in the same network.</p>
</div>
<p>At the fist screen looking like below. Note that it looks different from the screen from Local Server mode, which requires only URL of the web server.</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/pubnubapp-login.png"><img alt="_images/pubnubapp-login.png" src="_images/pubnubapp-login.png" /></a>
</div>
<p>Enter the same PubNub publish key, subscribe key, and channel name that you used for HKWHub app, and click <strong>Submit</strong>, as below.</p>
<p><a class="reference external" href="https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop/related?hl=en">https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop/related?hl=en</a></p>
<p>If you press <strong>Submit</strong>, then you will see the first screen like below. This is the list of media items available at the HKWHub app.</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/pubnubapp-medialist.png"><img alt="_images/pubnubapp-medialist.png" src="_images/pubnubapp-medialist.png" /></a>
</div>
<p>The UI of the Web app is exactly the same as HKIoTCloud web app. So, we skip to explain the rest parts of the app.</p>
</div>
</div>
<div class="section" id="use-curl-command-to-send-rest-requests">
<h3>Use <code class="docutils literal"><span class="pre">curl</span></code> command to send REST requests<a class="headerlink" href="#use-curl-command-to-send-rest-requests" title="Permalink to this headline">¶</a></h3>
<p>We show how to control Omni speakers by sending REST requests to HKIoTCloud. Sending REST requests to Local Server is almost the same.</p>
<p>You can use <strong>curl</strong> command in your shell to send REST requests.</p>
<p>If you are a chrome browser user, you can use <strong>Postman</strong> (<a class="reference external" href="https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop/related?hl=en">https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop/related?hl=en</a>) chrome extension to send HTTP requests with browser-based UI.</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/postman.png"><img alt="_images/postman.png" src="_images/postman.png" /></a>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Before you do this, do not forget to run HKWHub App and connect to HKIoTCloud.</p>
</div>
<div class="section" id="get-an-access-token-and-refresh-token-hkiotcloud-mode-only">
<h4>Get an Access Token and Refresh Token (HKIoTCloud mode only)<a class="headerlink" href="#get-an-access-token-and-refresh-token-hkiotcloud-mode-only" title="Permalink to this headline">¶</a></h4>
<p>In case of HKIoTCloud more, the client should get an access token from the HKIoTCloud to be able to call the REST APIs. HKIoTCloud supports two authorization modes: <strong>password</strong> and <strong>authorization code</strong>. For mode detailed information, please refer to the section of <a class="reference external" href="http://harmandeveloperdocs.readthedocs.org/en/latest/iOS/hkwhub-spec.html#id2">OAuth2 Authorization API Specification</a>.</p>
<p>With <strong>password</strong> grant mode, you can get an access token and a refresh token as shown below:</p>
<ul class="simple">
<li>curl -X POST -H &#8220;Authorization: Basic bjdIaGlUbktZakpkNHptTTpBTlJmQjl6OTR4dGN4RkdYcmQ1WEhYRWlLZzQzVVk=&#8221; -d &#8220;grant_type=password&amp;username=yyy&amp;password=xxx&#8221; <a class="reference external" href="http://hkiotcloud.herokuapp.com/oauth/token">http://hkiotcloud.herokuapp.com/oauth/token</a></li>
</ul>
<p>Result:</p>
<div class="code highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;token_type&quot;</span><span class="p">:</span><span class="s">&quot;bearer&quot;</span><span class="p">,</span>
 <span class="s">&quot;access_token&quot;</span><span class="p">:</span><span class="s">&quot;15c0507f3a550d7a31f7af5dc45e4dd9fd9f4bc8&quot;</span><span class="p">,</span>
 <span class="s">&quot;expires_in&quot;</span><span class="p">:</span><span class="mi">3600</span><span class="p">,</span>
 <span class="s">&quot;refresh_token&quot;</span><span class="p">:</span><span class="s">&quot;1b470edc539681803de95c919bc3779acdf34e01&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>When you call the HKIoTCloud API calls, you should pass the value of the access token into the request header. Specifically, create an <code class="docutils literal"><span class="pre">Authorization</span></code> header and give it the value <code class="docutils literal"><span class="pre">Bearer</span> <span class="pre">&lt;access</span> <span class="pre">token&gt;</span></code>.</p>
</div>
<div class="section" id="a-init-session">
<h4>a. Init session<a class="headerlink" href="#a-init-session" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>curl -H &#8220;Authorization: Bearer 15c0507f3a550d7a31f7af5dc45e4dd9fd9f4bc8&#8221; <a class="reference external" href="http://hkiotcloud.herokuapp.com/api/v1/init_session">http://hkiotcloud.herokuapp.com/api/v1/init_session</a></li>
</ul>
<p>This returns the SessionToken. The returned SessionToken is used by all subsequent REST API request in the body.</p>
<div class="code json highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;ResponseOf&quot;</span><span class="p">:</span><span class="s">&quot;init_session&quot;</span><span class="p">,</span><span class="s">&quot;SessionToken&quot;</span><span class="p">:</span><span class="s">&quot;r:abciKaTbUgdpQFuvYtgMm0FRh&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="b-add-alls-speaker-to-session">
<h4>b. Add alls speaker to session<a class="headerlink" href="#b-add-alls-speaker-to-session" title="Permalink to this headline">¶</a></h4>
<p>After HKWHub app is launched, none of speakers is selected for playback. You need to add one or more speakers to play audio. To add all speakers to playback session, use <code class="docutils literal"><span class="pre">set_party_mode</span></code>. <strong>Party Mode</strong> is the mode where all speakers are playing the same audio together with synchronization. So, by <code class="docutils literal"><span class="pre">set_party_mode</span></code>, you can select all speakers to play.</p>
<ul class="simple">
<li>curl -H &#8220;Authorization: Bearer 15c0507f3a550d7a31f7af5dc45e4dd9fd9f4bc8&#8221; &#8220;<a class="reference external" href="http://hkiotcloud.herokuapp.com/api/v1/set_party_mode?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh">http://hkiotcloud.herokuapp.com/api/v1/set_party_mode?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh</a>&#8220;</li>
</ul>
<div class="code json highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;Result&quot;</span><span class="p">:</span><span class="s">&quot;true&quot;</span><span class="p">,</span><span class="s">&quot;ResponseOf&quot;</span><span class="p">:</span><span class="s">&quot;set_party_mode&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="c-get-the-list-of-speakers-available">
<h4>c. Get the list of speakers available<a class="headerlink" href="#c-get-the-list-of-speakers-available" title="Permalink to this headline">¶</a></h4>
<p>To control speakers individually, you can get the list of speakers available by using <strong>device_list</strong> command.</p>
<ul class="simple">
<li>curl -H &#8220;Authorization: Bearer 15c0507f3a550d7a31f7af5dc45e4dd9fd9f4bc8&#8221; &#8220;<a class="reference external" href="http://hkiotcloud.herokuapp.com/api/v1/device_list?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh">http://hkiotcloud.herokuapp.com/api/v1/device_list?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh</a>&#8220;</li>
</ul>
<div class="code json highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;DeviceList&quot;</span><span class="p">:[</span>
        <span class="p">{</span>
                <span class="s">&quot;IsPlaying&quot;</span><span class="p">:</span><span class="n">false</span><span class="p">,</span>
                <span class="s">&quot;MacAddress&quot;</span><span class="p">:</span><span class="s">&quot;&quot;</span><span class="p">,</span>
                <span class="s">&quot;GroupName&quot;</span><span class="p">:</span><span class="s">&quot;Garage&quot;</span><span class="p">,</span>
                <span class="s">&quot;Role&quot;</span><span class="p">:</span><span class="mi">21</span><span class="p">,</span>
                <span class="s">&quot;Version&quot;</span><span class="p">:</span><span class="s">&quot;0.1.6.2&quot;</span><span class="p">,</span>
                <span class="s">&quot;Port&quot;</span><span class="p">:</span><span class="mi">44055</span><span class="p">,</span>
                <span class="s">&quot;Active&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">,</span>
                <span class="s">&quot;GroupID&quot;</span><span class="p">:</span><span class="s">&quot;4625984469&quot;</span><span class="p">,</span>
                <span class="s">&quot;ModelName&quot;</span><span class="p">:</span><span class="s">&quot;Omni Adapt&quot;</span><span class="p">,</span>
                <span class="s">&quot;DeviceID&quot;</span><span class="p">:</span><span class="s">&quot;4625984469168&quot;</span><span class="p">,</span>
                <span class="s">&quot;IPAddress&quot;</span><span class="p">:</span><span class="s">&quot;10.0.1.6&quot;</span><span class="p">,</span>
                <span class="s">&quot;Volume&quot;</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span>
                <span class="s">&quot;DeviceName&quot;</span><span class="p">:</span><span class="s">&quot;Adapt&quot;</span><span class="p">,</span>
                <span class="s">&quot;WifiSignalStrength&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">62</span>
        <span class="p">},</span>
        <span class="p">{</span>
                <span class="s">&quot;IsPlaying&quot;</span><span class="p">:</span><span class="n">false</span><span class="p">,</span>
                <span class="s">&quot;MacAddress&quot;</span><span class="p">:</span><span class="s">&quot;b0:38:29:11:19:54&quot;</span><span class="p">,</span>
                <span class="s">&quot;GroupName&quot;</span><span class="p">:</span><span class="s">&quot;Living Room&quot;</span><span class="p">,</span>
                <span class="s">&quot;Role&quot;</span><span class="p">:</span><span class="mi">21</span><span class="p">,</span>
                <span class="s">&quot;Version&quot;</span><span class="p">:</span><span class="s">&quot;0.1.6.2&quot;</span><span class="p">,</span>
                <span class="s">&quot;Port&quot;</span><span class="p">:</span><span class="mi">44055</span><span class="p">,</span>
                <span class="s">&quot;Active&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">,</span>
                <span class="s">&quot;GroupID&quot;</span><span class="p">:</span><span class="s">&quot;9246663882&quot;</span><span class="p">,</span>
                <span class="s">&quot;ModelName&quot;</span><span class="p">:</span><span class="s">&quot;Omni 10&quot;</span><span class="p">,</span>
                <span class="s">&quot;DeviceID&quot;</span><span class="p">:</span><span class="s">&quot;92466638829744&quot;</span><span class="p">,</span>
                <span class="s">&quot;IPAddress&quot;</span><span class="p">:</span><span class="s">&quot;10.0.1.9&quot;</span><span class="p">,</span>
                <span class="s">&quot;Volume&quot;</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span>
                <span class="s">&quot;DeviceName&quot;</span><span class="p">:</span><span class="s">&quot;Omni Left&quot;</span><span class="p">,</span>
                <span class="s">&quot;WifiSignalStrength&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">67</span>
        <span class="p">}</span>
<span class="p">],</span>
<span class="s">&quot;ResponseOf&quot;</span><span class="p">:</span><span class="s">&quot;device_list&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="d-add-a-speaker-to-session">
<h4>d. Add a speaker to session<a class="headerlink" href="#d-add-a-speaker-to-session" title="Permalink to this headline">¶</a></h4>
<p>If you want to add a speaker to session, use <code class="docutils literal"><span class="pre">add_device_to_session`.</span> <span class="pre">It</span> <span class="pre">requires</span> <span class="pre">``DeviceID</span></code> parameter to identify a speaker to add. This command does not impact other speakers regardless of their status.</p>
<ul class="simple">
<li>curl -H &#8220;Authorization: Bearer 15c0507f3a550d7a31f7af5dc45e4dd9fd9f4bc8&#8221; &#8220;<a class="reference external" href="http://hkiotcloud.herokuapp.com/api/v1/add_device_to_session?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh&amp;DeviceID=4625984469168">http://hkiotcloud.herokuapp.com/api/v1/add_device_to_session?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh&amp;DeviceID=4625984469168</a>&#8220;</li>
</ul>
<div class="code json highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;Result&quot;</span><span class="p">:</span><span class="s">&quot;true&quot;</span><span class="p">,</span><span class="s">&quot;ResponseOf&quot;</span><span class="p">:</span><span class="s">&quot;add_device_to_session&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="e-get-the-media-list">
<h4>e. Get the media list<a class="headerlink" href="#e-get-the-media-list" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>curl -H &#8220;Authorization: Bearer 15c0507f3a550d7a31f7af5dc45e4dd9fd9f4bc8&#8221; &#8220;<a class="reference external" href="http://hkiotcloud.herokuapp.com/api/v1/media_list?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh">http://hkiotcloud.herokuapp.com/api/v1/media_list?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh</a>&#8220;</li>
</ul>
<p>Here, SessionToken should be the session token you got from <code class="docutils literal"><span class="pre">init_session</span></code>. You will get a list of media in JSON like below</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;MediaList&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="nt">&quot;PersistentID&quot;</span><span class="p">:</span><span class="s2">&quot;7387446959931482519&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Title&quot;</span><span class="p">:</span><span class="s2">&quot;I Will Run To You&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Artist&quot;</span><span class="p">:</span><span class="s2">&quot;Hillsong&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Duration&quot;</span><span class="p">:</span><span class="mi">436</span><span class="p">,</span>
        <span class="nt">&quot;AlbumTitle&quot;</span><span class="p">:</span><span class="s2">&quot;Simply Worship&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span><span class="nt">&quot;PersistentID&quot;</span><span class="p">:</span><span class="s2">&quot;5829171347867182746&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Title&quot;</span><span class="p">:</span><span class="s2">&quot;I&#39;m Yours [ORIGINAL DEMO]&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Artist&quot;</span><span class="p">:</span><span class="s2">&quot;Jason Mraz&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Duration&quot;</span><span class="p">:</span><span class="mi">257</span><span class="p">,</span>
        <span class="nt">&quot;AlbumTitle&quot;</span><span class="p">:</span><span class="s2">&quot;Wordplay [SINGLE EP]&quot;</span><span class="p">}</span>
<span class="p">]}</span>
</pre></div>
</div>
</div>
<div class="section" id="f-play-a-media-item-listed-in-the-hkwhub-app">
<h4>f. Play a media item listed in the HKWHub app<a class="headerlink" href="#f-play-a-media-item-listed-in-the-hkwhub-app" title="Permalink to this headline">¶</a></h4>
<p>If you want to play a media item listed in the HKWHub app, use <code class="docutils literal"><span class="pre">play_hub_media</span></code> by specifying the media item with <code class="docutils literal"><span class="pre">PersistentID</span></code>. The <code class="docutils literal"><span class="pre">PersistentID</span></code> is available from the response of <code class="docutils literal"><span class="pre">media_list</span></code> command.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that, before calling <code class="docutils literal"><span class="pre">play_hub_media</span></code>, at least one or more speakers must be selected (added to session) in advance. If not, then the playback will fail.</p>
</div>
<ul class="simple">
<li>curl -H &#8220;Authorization: Bearer 15c0507f3a550d7a31f7af5dc45e4dd9fd9f4bc8&#8221; &#8220;<a class="reference external" href="http://hkiotcloud.herokuapp.com/api/v1/play_hub_media?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh&amp;PersistentID=1062764963669236741">http://hkiotcloud.herokuapp.com/api/v1/play_hub_media?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh&amp;PersistentID=1062764963669236741</a>&#8220;</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="nt">&quot;ResponseOf&quot;</span><span class="p">:</span><span class="s2">&quot;play_hub_media&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="f-play-a-media-item-in-the-hkwhub-by-specifying-a-speaker-list-to-play">
<h4>f. Play a media item in the HKWHub by specifying a speaker list to play<a class="headerlink" href="#f-play-a-media-item-in-the-hkwhub-by-specifying-a-speaker-list-to-play" title="Permalink to this headline">¶</a></h4>
<p>You can play a media item in the HKWHub app by specifying the list of speakers.</p>
<ul class="simple">
<li>curl -H &#8220;Authorization: Bearer 15c0507f3a550d7a31f7af5dc45e4dd9fd9f4bc8&#8221; &#8220;<a class="reference external" href="http://hkiotcloud.herokuapp.com/api/v1/play_hub_media_selected_speakers?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh&amp;PersistentID=1062764963669236741&amp;DeviceIDList=34317244381360,129321920968880">http://hkiotcloud.herokuapp.com/api/v1/play_hub_media_selected_speakers?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh&amp;PersistentID=1062764963669236741&amp;DeviceIDList=34317244381360,129321920968880</a>&#8220;</li>
</ul>
<p>The list of speakers are listed by the parameter <code class="docutils literal"><span class="pre">DeviceIDList</span></code> with delimitor &#8221;,&#8221;.</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="nt">&quot;ResponseOf&quot;</span><span class="p">:</span><span class="s2">&quot;play_hub_media_selected_speakers&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="g-play-a-http-streaming-media-as-party-mode">
<h4>g. Play a HTTP streaming media as party mode<a class="headerlink" href="#g-play-a-http-streaming-media-as-party-mode" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>curl -H &#8220;Authorization: Bearer 15c0507f3a550d7a31f7af5dc45e4dd9fd9f4bc8&#8221; &#8220;<a class="reference external" href="http://hkiotcloud.herokuapp.com/api/v1/play_web_media_party_mode?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh&amp;MediaUrl=http://seonman.github.io/music/hyolyn.mp3">http://hkiotcloud.herokuapp.com/api/v1/play_web_media_party_mode?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh&amp;MediaUrl=http://seonman.github.io/music/hyolyn.mp3</a>&#8220;</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="nt">&quot;ResponseOf&quot;</span><span class="p">:</span><span class="s2">&quot;play_web_media_party_mode&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="h-stop-playing">
<h4>h. Stop playing<a class="headerlink" href="#h-stop-playing" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>curl -H &#8220;Authorization: Bearer 15c0507f3a550d7a31f7af5dc45e4dd9fd9f4bc8&#8221; &#8220;<a class="reference external" href="http://hkiotcloud.herokuapp.com/api/v1/stop_play?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh">http://hkiotcloud.herokuapp.com/api/v1/stop_play?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh</a>&#8220;</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="nt">&quot;ResponseOf&quot;</span><span class="p">:</span><span class="s2">&quot;stop_play&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="i-set-volume">
<h4>i. Set Volume<a class="headerlink" href="#i-set-volume" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>curl -H &#8220;Authorization: Bearer 15c0507f3a550d7a31f7af5dc45e4dd9fd9f4bc8&#8221; &#8220;<a class="reference external" href="http://hkiotcloud.herokuapp.com/api/v1/set_volume?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh&amp;Volume=30">http://hkiotcloud.herokuapp.com/api/v1/set_volume?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh&amp;Volume=30</a>&#8220;</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">,</span><span class="nt">&quot;ResponseOf&quot;</span><span class="p">:</span><span class="s2">&quot;set_volume&quot;</span><span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please see the REST API specification for more information and examples.</p>
</div>
</div>
</div>
</div>
<div class="section" id="playback-session-management">
<h2>Playback Session Management<a class="headerlink" href="#playback-session-management" title="Permalink to this headline">¶</a></h2>
<p>Since the HKWHub app should be able to handle REST HTTP requests from more than one clients at the same time, the HKWHub app manages the requests with session information associated with the priority when a new playback is initiated.</p>
<p>The following is the policy of the session management:</p>
<div class="section" id="playback-session-creation">
<h3>Playback Session Creation<a class="headerlink" href="#playback-session-creation" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>When a client wants to start a playback, it sets the priority of the session (using <code class="docutils literal"><span class="pre">Priority=&lt;priority</span> <span class="pre">value&gt;</span></code> parameter).</li>
<li>If Priority parameter is not specified, HKWHub app assumes it as default value, that is, 100.</li>
</ul>
</div>
<div class="section" id="priority-of-session">
<h3>Priority of Session<a class="headerlink" href="#priority-of-session" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Each session is associated with a priority value which will be used to determine which request can override the current on-going playback session.</p>
</li>
<li><dl class="first docutils">
<dt>The priority value is specified as parameter (<code class="docutils literal"><span class="pre">Priority</span></code>) when the client calls <code class="docutils literal"><span class="pre">play_xxx</span></code>.</dt>
<dd><ul class="first last simple">
<li>If the command does not specify the Priority parameter, 100 is set as default value.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If the priority of a new playback request, such as <code class="docutils literal"><span class="pre">play_hub_media</span></code> or <code class="docutils literal"><span class="pre">play_web_media</span></code>, and so on, is greater than or equal to the priority of the current playback session, then it interrupts the current playback session, that is, stops the current playback session and start a new playback for itself.</dt>
<dd><ul class="first last simple">
<li>The playback status of the interrupted session becomes <code class="docutils literal"><span class="pre">PlayerStateStopped</span></code>. (see the related API in the next section)</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>The following diagrams show how HKWHub app handles incoming playback request based on the session priorities.</p>
<div class="figure">
<img alt="Session management flow diagram" src="_images/session-management.png" />
</div>
</div>
<div class="section" id="session-timeout">
<h3>Session Timeout<a class="headerlink" href="#session-timeout" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>A session becomes expired and invalid when about 60 minutes is passed since the last command was received.</li>
<li>Session timer is extended (renewed) once a playback is executed successfully.</li>
<li>All requests with expired session will be denied and &#8220;SessionNotFound&#8221; error returns.</li>
</ul>
</div>
</div>
<hr class="docutils" />
<div class="section" id="rest-api-specification-including-pubnub-json-format">
<h2>REST API Specification (including PubNub JSON format)<a class="headerlink" href="#rest-api-specification-including-pubnub-json-format" title="Permalink to this headline">¶</a></h2>
<p>This specification describes about the REST APIs to control HK Omni speakers and stream audio to the speakers via HKWHub app.</p>
<p>All the APIS are in REST API protocol.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In this documentation, for HKIoTCloud mode, &lt;server_host&gt; should be &#8220;hkiotcloud.herokuapp.com&#8221;.
For Local server mode, &lt;server_host&gt; should be the URL (IP address and port number) tat HKWHub app is showing.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>PubNub server mode does not use REST API. Instead, PubNub client needs to subscribe to the PubNub channel to get events from HKWHub, and use publish message to the PubNub channel to send request to HKWHub. The commands and parameters of each command are the same as REST API specification. However, PubNub message needs to include a couple of additional parameters in the JSON data to specify the <strong>HKWHub UUID (HKWHubUUID)</strong> that are talking to. The response message coming from the HKWHub app will include <strong>ResponseOf</strong> parameters to specify which request the resonse was for.</p>
<p class="last">So, we will describe PubNub message specification along with REST API specification here.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All the REST request should contain <code class="docutils literal"><span class="pre">Authorization</span></code> header that contains the access token, as described above.</p>
</div>
<div class="section" id="session-management">
<h3>Session Management<a class="headerlink" href="#session-management" title="Permalink to this headline">¶</a></h3>
<div class="section" id="start-session">
<h4>Start Session<a class="headerlink" href="#start-session" title="Permalink to this headline">¶</a></h4>
<p>This starts a new session. As a response, the client will receive a SessionToken. The SessionToken is required to be sent in any following requests. Note that the REST requests differs depending on the server mode.</p>
<ul>
<li><p class="first">API: GET /api/v1/init_session</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Returns a unique session token</li>
<li>The session token will be used for upcoming requests.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>curl -H &quot;Authorization: Bearer 15c0507f3a550d7a31f7af5dc45e4dd9fd9f4bc8&quot; http://&lt;server_host&gt;/api/v1/init_session
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;ResponseOf&quot;</span><span class="p">:</span><span class="s2">&quot;init_session&quot;</span><span class="p">,</span><span class="nt">&quot;SessionToken&quot;</span><span class="p">:</span><span class="s2">&quot;r:abciKaTbUgdpQFuvYtgMm0FRh&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{Command = &quot;init_session&quot;}
</pre></div>
</div>
<ul>
<li><dl class="first docutils">
<dt>Message from HKWHub (via Subscribe)</dt>
<dd><ul class="first last simple">
<li>Note that the response of <code class="docutils literal"><span class="pre">init_session</span></code> will contain <strong>HKWHubUUID</strong> to identify the HKWHub the PubNub client is getting talking to. The subsequent Publish message should include this HKWHubUUID information as well as SessionToken.</li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;init_session&quot;
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="close-session">
<h4>Close Session<a class="headerlink" href="#close-session" title="Permalink to this headline">¶</a></h4>
<p>Close the session. The SessionToken information is removed from the session table.</p>
<ul>
<li><p class="first">API: GET /api/v1/close_session?SessionToken=&lt;session token&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Returns true or false indicating success or failure</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/close_session?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span> <span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
Command = &quot;close_session&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;close_session&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
</div>
<hr class="docutils" />
<div class="section" id="device-management">
<h3>Device Management<a class="headerlink" href="#device-management" title="Permalink to this headline">¶</a></h3>
<div class="section" id="get-the-device-count">
<h4>Get the device count<a class="headerlink" href="#get-the-device-count" title="Permalink to this headline">¶</a></h4>
<p>Returns the number of speakers available in the network.</p>
<ul>
<li><p class="first">API: GET /api/v1/device_count?SessionToken=&lt;session token&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Returns the number of devices connected to the network</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/device_count?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;DeviceCount&quot;</span><span class="p">:</span><span class="s2">&quot;2&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
Command = &quot;device_count&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;device_count&quot;,
DeviceCount = 2
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="get-the-list-of-devices-and-their-information">
<h4>Get the list of devices and their information<a class="headerlink" href="#get-the-list-of-devices-and-their-information" title="Permalink to this headline">¶</a></h4>
<p>Returns the list of speakers and their information including several status information.</p>
<ul>
<li><p class="first">API: GET /api/v1/device_list?SessionToken=&lt;session token&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Returns the list of devices with all the device information</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/device_list?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh
</pre></div>
</div>
<ul class="last simple">
<li>Response:</li>
</ul>
</dd>
</dl>
</li>
</ul>
<blockquote>
<div><div class="highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;DeviceList&quot;</span><span class="p">:</span>
             <span class="p">[{</span><span class="nt">&quot;GroupName&quot;</span><span class="p">:</span><span class="s2">&quot;Bathroom&quot;</span><span class="p">,</span>
             <span class="nt">&quot;Role&quot;</span><span class="p">:</span><span class="mi">21</span><span class="p">,</span>
             <span class="nt">&quot;MacAddress&quot;</span><span class="p">:</span><span class="s2">&quot;b0:38:29:1b:36:1f&quot;</span><span class="p">,</span>
             <span class="nt">&quot;WifiSignalStrength&quot;</span><span class="p">:</span><span class="mi">-47</span><span class="p">,</span>
             <span class="nt">&quot;Port&quot;</span><span class="p">:</span><span class="mi">44055</span><span class="p">,</span>
             <span class="nt">&quot;Active&quot;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
             <span class="nt">&quot;DeviceName&quot;</span><span class="p">:</span><span class="s2">&quot;Adapt1&quot;</span><span class="p">,</span>
             <span class="nt">&quot;Version&quot;</span><span class="p">:</span><span class="s2">&quot;0.1.6.2&quot;</span><span class="p">,</span>
             <span class="nt">&quot;ModelName&quot;</span><span class="p">:</span><span class="s2">&quot;Omni Adapt&quot;</span><span class="p">,</span>
             <span class="nt">&quot;IPAddress&quot;</span><span class="p">:</span><span class="s2">&quot;192.168.1.40&quot;</span><span class="p">,</span>
             <span class="nt">&quot;GroupID&quot;</span><span class="p">:</span><span class="s2">&quot;3431724438&quot;</span><span class="p">,</span>
             <span class="nt">&quot;Volume&quot;</span><span class="p">:</span><span class="mi">47</span><span class="p">,</span>
             <span class="nt">&quot;IsPlaying&quot;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span>
             <span class="nt">&quot;DeviceID&quot;</span><span class="p">:</span><span class="s2">&quot;34317244381360&quot;</span>
             <span class="p">},</span>
     <span class="p">{</span><span class="nt">&quot;GroupName&quot;</span><span class="p">:</span><span class="s2">&quot;Temp&quot;</span><span class="p">,</span>
             <span class="nt">&quot;Role&quot;</span><span class="p">:</span><span class="mi">21</span><span class="p">,</span>
             <span class="nt">&quot;MacAddress&quot;</span><span class="p">:</span><span class="s2">&quot;b0:38:29:1b:9e:75&quot;</span><span class="p">,</span>
             <span class="nt">&quot;WifiSignalStrength&quot;</span><span class="p">:</span><span class="mi">-53</span><span class="p">,</span>
             <span class="nt">&quot;Port&quot;</span><span class="p">:</span><span class="mi">44055</span><span class="p">,</span>
             <span class="nt">&quot;Active&quot;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
             <span class="nt">&quot;DeviceName&quot;</span><span class="p">:</span><span class="s2">&quot;Adapt&quot;</span><span class="p">,</span>
             <span class="nt">&quot;Version&quot;</span><span class="p">:</span><span class="s2">&quot;0.1.6.2&quot;</span><span class="p">,</span>
             <span class="nt">&quot;ModelName&quot;</span><span class="p">:</span><span class="s2">&quot;Omni Adapt&quot;</span><span class="p">,</span>
             <span class="nt">&quot;IPAddress&quot;</span><span class="p">:</span><span class="s2">&quot;192.168.1.39&quot;</span><span class="p">,</span>
             <span class="nt">&quot;GroupID&quot;</span><span class="p">:</span><span class="s2">&quot;1293219209&quot;</span><span class="p">,</span>
             <span class="nt">&quot;Volume&quot;</span><span class="p">:</span><span class="mi">47</span><span class="p">,</span>
             <span class="nt">&quot;IsPlaying&quot;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span>
             <span class="nt">&quot;DeviceID&quot;</span><span class="p">:</span><span class="s2">&quot;129321920968880&quot;</span>
             <span class="p">}]</span>
     <span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<ul>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
Command = &quot;device_list&quot;,
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Response message (from Subscribed)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
<blockquote>
<div><div class="highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;device_list&quot;,
DeviceList =
             [{&quot;GroupName&quot;:&quot;Bathroom&quot;,
             &quot;Role&quot;:21,
             &quot;MacAddress&quot;:&quot;b0:38:29:1b:36:1f&quot;,
             &quot;WifiSignalStrength&quot;:-47,
             &quot;Port&quot;:44055,
             &quot;Active&quot;:true,
             &quot;DeviceName&quot;:&quot;Adapt1&quot;,
             &quot;Version&quot;:&quot;0.1.6.2&quot;,
             &quot;ModelName&quot;:&quot;Omni Adapt&quot;,
             &quot;IPAddress&quot;:&quot;192.168.1.40&quot;,
             &quot;GroupID&quot;:&quot;3431724438&quot;,
             &quot;Volume&quot;:47,
             &quot;IsPlaying&quot;:false,
             &quot;DeviceID&quot;:&quot;34317244381360&quot;
             },
             {&quot;GroupName&quot;:&quot;Temp&quot;,
             &quot;Role&quot;:21,
             &quot;MacAddress&quot;:&quot;b0:38:29:1b:9e:75&quot;,
             &quot;WifiSignalStrength&quot;:-53,
             &quot;Port&quot;:44055,
             &quot;Active&quot;:true,
             &quot;DeviceName&quot;:&quot;Adapt&quot;,
             &quot;Version&quot;:&quot;0.1.6.2&quot;,
             &quot;ModelName&quot;:&quot;Omni Adapt&quot;,
             &quot;IPAddress&quot;:&quot;192.168.1.39&quot;,
             &quot;GroupID&quot;:&quot;1293219209&quot;,
             &quot;Volume&quot;:47,
             &quot;IsPlaying&quot;:false,
             &quot;DeviceID&quot;:&quot;129321920968880&quot;
             }]
     }
</pre></div>
</div>
</div></blockquote>
</div>
<hr class="docutils" />
<div class="section" id="get-the-device-information">
<h4>Get the Device Information<a class="headerlink" href="#get-the-device-information" title="Permalink to this headline">¶</a></h4>
<p>Gets the device information of a particular device (speaker) identified by DeviceID.</p>
<ul>
<li><p class="first">API: GET /api/v1/device_info?SessionToken=&lt;session token&gt;&amp;DeviceID=&lt;device id&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Returns the information of the device</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/device_info?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh&amp;DeviceID=129321920968880
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;GroupName&quot;</span><span class="p">:</span><span class="s2">&quot;Temp&quot;</span><span class="p">,</span>
<span class="nt">&quot;Role&quot;</span><span class="p">:</span><span class="mi">21</span><span class="p">,</span>
<span class="nt">&quot;MacAddress&quot;</span><span class="p">:</span><span class="s2">&quot;b0:38:29:1b:9e:75&quot;</span><span class="p">,</span>
<span class="nt">&quot;WifiSignalStrength&quot;</span><span class="p">:</span><span class="mi">-52</span><span class="p">,</span>
<span class="nt">&quot;Port&quot;</span><span class="p">:</span><span class="mi">44055</span><span class="p">,</span>
<span class="nt">&quot;Active&quot;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
<span class="nt">&quot;DeviceName&quot;</span><span class="p">:</span><span class="s2">&quot;Adapt&quot;</span><span class="p">,</span>
<span class="nt">&quot;Version&quot;</span><span class="p">:</span><span class="s2">&quot;0.1.6.2&quot;</span><span class="p">,</span>
<span class="nt">&quot;ModelName&quot;</span><span class="p">:</span><span class="s2">&quot;Omni Adapt&quot;</span><span class="p">,</span>
<span class="nt">&quot;IPAddress&quot;</span><span class="p">:</span><span class="s2">&quot;192.168.1.39&quot;</span><span class="p">,</span>
<span class="nt">&quot;GroupID&quot;</span><span class="p">:</span><span class="s2">&quot;1293219209&quot;</span><span class="p">,</span>
<span class="nt">&quot;Volume&quot;</span><span class="p">:</span><span class="mi">47</span><span class="p">,</span>
<span class="nt">&quot;IsPlaying&quot;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
<span class="nt">&quot;DeviceID&quot;</span><span class="p">:</span><span class="s2">&quot;129321920968880&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
Command = &quot;device_list&quot;,
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Response message (from Subscribed)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;device_list&quot;,
GroupName: &quot;Temp&quot;,
Role = 21,
MacAddress = &quot;b0:38:29:1b:9e:75&quot;,
WifiSignalStrength = -52,
Port = 44055,
Active = true,
DeviceName = &quot;Adapt&quot;,
Version = &quot;0.1.6.2&quot;,
ModelName = Omni Adapt&quot;,
IPAddress = &quot;192.168.1.39&quot;,
GroupID = 1293219209&quot;,
Volume = 47,
IsPlaying = true,
DeviceID = 129321920968880&quot;
     }
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="add-a-device-to-session">
<h4>Add a Device to Session<a class="headerlink" href="#add-a-device-to-session" title="Permalink to this headline">¶</a></h4>
<p>Add a speaker to playback session. Once a speaker is added, then the speaker will play the music. There is no impact of this call to other speakers.</p>
<ul>
<li><p class="first">API: GET /api/v1/add_device_to_session?SessionToken=&lt;session token&gt;&amp;DeviceID=&lt;device id&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Returns true or false</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/add_device_to_session?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh&amp;DeviceID=129321920968880
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
Command = &quot;add_device_to_session&quot;,
DeviceID = &quot;129321920968880&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;add_device_to_session&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="remove-a-device-from-session">
<h4>Remove a Device from Session<a class="headerlink" href="#remove-a-device-from-session" title="Permalink to this headline">¶</a></h4>
<p>Removes a speaker from playback session. Once a speaker is removed, then the speaker will not play the music. There is no impact of this call to other speakers.</p>
<ul>
<li><p class="first">API: GET /api/v1/remove_device_from_session?SessionToken=&lt;session token&gt;&amp;DeviceID=&lt;device id&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Returns true or false</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/remove_device_from_session?SessionToken=r:abciKaTbUgdpQFuvYtgMm0FRh&amp;DeviceID=129321920968880
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
Command = &quot;remove_device_from_session&quot;,
DeviceID = &quot;129321920968880&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;remove_device_from_session&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="set-party-mode">
<h4>Set party mode<a class="headerlink" href="#set-party-mode" title="Permalink to this headline">¶</a></h4>
<p>Addes all speakers to playback session. Once it is done, all speakers will play music.</p>
<ul>
<li><p class="first">API: GET /api/v1/set_party_mode?SessionToken=&lt;session token&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Returns true or false</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/set_party_mode?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SesssionToken = &quot;PubNub-1000&quot;,
Command = &quot;set_party_mode&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
ResponseOf = &quot;set_party_mode&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
</div>
<hr class="docutils" />
<div class="section" id="media-playback-management">
<h3>Media Playback Management<a class="headerlink" href="#media-playback-management" title="Permalink to this headline">¶</a></h3>
<div class="section" id="get-the-list-of-media-item-in-the-media-list-of-the-hkwhub-app">
<h4>Get the list of media item in the Media List of the HKWHub app<a class="headerlink" href="#get-the-list-of-media-item-in-the-media-list-of-the-hkwhub-app" title="Permalink to this headline">¶</a></h4>
<p>Returns the list of media items added to the Media List of the app. User can add music items to the <strong>Media List</strong> of the app via <strong>Setting</strong> of the app.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>A music item downloaded from Apple Music is not supported. The music file from Apple music is DRM-enabled, and cannot be played with HKWirelessHD. Only music items purchased from iTunes Music or added from user&#8217;s own library are supported.</p>
<p class="last">To be added to the Media List, the music item must be located locally on the device. No streaming from iTunes or Apple Music are supported.</p>
</div>
<ul>
<li><p class="first">API: GET /api/v1/media_list?SessionToken=&lt;session token&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Returns JSON of the list of store media in the HKWHub app.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/media_list?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;MediaList&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="nt">&quot;PersistentID&quot;</span><span class="p">:</span><span class="s2">&quot;7387446959931482519&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Title&quot;</span><span class="p">:</span><span class="s2">&quot;I Will Run To You&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Artist&quot;</span><span class="p">:</span><span class="s2">&quot;Hillsong&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Duration&quot;</span><span class="p">:</span><span class="mi">436</span><span class="p">,</span>
        <span class="nt">&quot;AlbumTitle&quot;</span><span class="p">:</span><span class="s2">&quot;Simply Worship&quot;</span>
<span class="p">},</span>
        <span class="p">{</span><span class="nt">&quot;PersistentID&quot;</span><span class="p">:</span><span class="s2">&quot;5829171347867182746&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Title&quot;</span><span class="p">:</span><span class="s2">&quot;I&#39;m Yours [ORIGINAL DEMO]&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Artist&quot;</span><span class="p">:</span><span class="s2">&quot;Jason Mraz&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Duration&quot;</span><span class="p">:</span><span class="mi">257</span><span class="p">,</span>
        <span class="nt">&quot;AlbumTitle&quot;</span><span class="p">:</span><span class="s2">&quot;Wordplay [SINGLE EP]&quot;</span><span class="p">}</span>
        <span class="p">]}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{Command = &quot;media_list&quot;,
 HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
 SesssionToken = &quot;PubNub-1000&quot;}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
MediaList = [
        {&quot;PersistentID&quot;:&quot;7387446959931482519&quot;,
        &quot;Title&quot;:&quot;I Will Run To You&quot;,
        &quot;Artist&quot;:&quot;Hillsong&quot;,
        &quot;Duration&quot;:436,
        &quot;AlbumTitle&quot;:&quot;Simply Worship&quot;
        },
        {&quot;PersistentID&quot;:&quot;5829171347867182746&quot;,
        &quot;Title&quot;:&quot;I&#39;m Yours [ORIGINAL DEMO]&quot;,
        &quot;Artist&quot;:&quot;Jason Mraz&quot;,
        &quot;Duration&quot;:257,
        &quot;AlbumTitle&quot;:&quot;Wordplay [SINGLE EP]&quot;}
        ],
ResponseOf = &quot;media_list&quot;
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="play-a-song-in-the-media-list-of-the-hkwhub-app">
<h4>Play a song in the Media List of the HKWHub app<a class="headerlink" href="#play-a-song-in-the-media-list-of-the-hkwhub-app" title="Permalink to this headline">¶</a></h4>
<p>Plays a song in the Media List of the Hub app. Each music item is identified with MPMediaItem&#8217;s PersistentID. It is a unique ID to identify a song in the iOS Music library.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">play_hub_media</span></code> does not specify speakers to play. It just uses the current session setting. If there is no speaker in the current session, then the play fails.</p>
</div>
<ul>
<li><p class="first">API: GET /api/v1/play_hub_media?SessionToken=&lt;session token&gt;&amp;PersistentID=&lt;persistent id&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Play a song stored in the hub, and then return true or false.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/play_hub_media?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F&amp;PersistentID=7387446959931482519
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
Command = &quot;play_hub_media&quot;,
PersistentID = 7387446959931482519,
SesssionToken = &quot;PubNub-1000&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;play_hub_media&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="play-a-song-in-the-media-list-as-party-mode">
<h4>Play a song in the Media list as party mode<a class="headerlink" href="#play-a-song-in-the-media-list-as-party-mode" title="Permalink to this headline">¶</a></h4>
<p>Plays a song in the Media List with all speakers available. So, regardless of current session setting, this command play a song to all speakers.</p>
<ul>
<li><p class="first">API: GET /api/v1/play_hub_media_party_mode?SessionToken=&lt;session token&gt;&amp;PersistentID=&lt;persistent id&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Play a song in the hub&#8217;s media list to all speakers, and then return true or false.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/play_hub_media_party_mode?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F&amp;PersistentID=7387446959931482519
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
Command = &quot;play_hub_media_party_mode&quot;,
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
PersistentID = 7387446959931482519,
SesssionToken = &quot;PubNub-1000&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;play_hub_media_party_mode&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="play-a-song-in-the-media-list-with-selected-speakers">
<h4>Play a song in the Media list with selected speakers<a class="headerlink" href="#play-a-song-in-the-media-list-with-selected-speakers" title="Permalink to this headline">¶</a></h4>
<p>Plays a song in the Media List with selected speakers. The selected speakers are represented in <code class="docutils literal"><span class="pre">DeviceIDList</span></code> parameter as a list of <code class="docutils literal"><span class="pre">DeviceID</span></code> separated by &#8221;,&#8221;.</p>
<ul>
<li><p class="first">API: GET /api/v1/play_hub_media_selected_speakers?SessionToken=&lt;session token&gt;&amp;PersistentID=&lt;persistent id&gt;&amp;DeviceIDList=&lt;xxx,xxx,...&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Play a song in the hub&#8217;s media list to selected speakers, and then return true or false.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/play_hub_media_selected_speakers?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F&amp;PersistentID=7387446959931482519&amp;DeviceIDList=34317244381360,129321920968880
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
Command = &quot;play_hub_media_selected_speakers&quot;,
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
PersistentID = 7387446959931482519,
SesssionToken = &quot;PubNub-1000&quot;,
DeviceIDList = 34317244381360,129321920968880
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;play_hub_media_selected_speakers&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="play-a-song-from-web-server">
<h4>Play a Song from Web Server<a class="headerlink" href="#play-a-song-from-web-server" title="Permalink to this headline">¶</a></h4>
<p>Plays a song from Web (http:) or rstp (rstp:) or mms (mms:) server. The URL of the song to play is specified by <code class="docutils literal"><span class="pre">MediaUrl</span></code> parameter.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">play_web_media</span></code> does not specify speakers to play. It just uses the current session setting. If there is no speaker in the current session, then the play fails.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">play_web_media</span></code> cannot be resumed. If it is paused by calling <code class="docutils literal"><span class="pre">pause</span></code>, then it just stops playing music, and cannot resume.</p>
</div>
<ul>
<li><p class="first">API: GET /api/v1/play_web_media?SessionToken=&lt;session token&gt;&amp;MediaUrl=&lt;URL of the song&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Play a song from HTTP server, and then return true or false.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host_name&gt;/api/v1/play_web_media?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F&amp;MediaUrl=http://seonman.github.io/music/hyolyn.mp3
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This API call takes several hundreds millisecond to return the response.</p>
</div>
<ul>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
Command = &quot;play_web_media&quot;,
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
MediaUrl = &quot;http://seonman.github.io/music/hyolyn.mp3&quot;
SesssionToken = &quot;PubNub-1000&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;play_web_media&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="play-a-song-from-web-server-as-party-mode">
<h4>Play a Song from Web Server as party mode<a class="headerlink" href="#play-a-song-from-web-server-as-party-mode" title="Permalink to this headline">¶</a></h4>
<p>Plays a song from Web server with all speakers. The URL of the song to play is specified by <code class="docutils literal"><span class="pre">MediaUrl</span></code> parameter.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">play_web_media</span></code> cannot be resumed. If it is paused by calling <code class="docutils literal"><span class="pre">pause</span></code>, then it just stops playing music, and cannot resume.</p>
</div>
<ul>
<li><p class="first">API: GET /api/v1/play_web_media_party_mode?SessionToken=&lt;session token&gt;&amp;MediaUrl=&lt;URL of the song&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Play a song from HTTP server to all speakers, and then return true or false.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/play_web_media_party_mode?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F&amp;MediaUrl=http://seonman.github.io/music/hyolyn.mp3
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This API call takes several hundreds millisecond to return the response.</p>
</div>
<ul>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
Command = &quot;play_web_media_party_mode&quot;,
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
MediaUrl = &quot;http://seonman.github.io/music/hyolyn.mp3&quot;
SesssionToken = &quot;PubNub-1000&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;play_web_media_party_mode&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="play-a-song-from-web-server-with-selected-speakers">
<h4>Play a Song from Web Server with selected speakers<a class="headerlink" href="#play-a-song-from-web-server-with-selected-speakers" title="Permalink to this headline">¶</a></h4>
<p>Plays a song from Web server with selected speakers. The URL of the song to play is specified by <code class="docutils literal"><span class="pre">MediaUrl</span></code> parameter. The selected speakers are represented in <code class="docutils literal"><span class="pre">DeviceIDList</span></code> parameter as a list of <code class="docutils literal"><span class="pre">DeviceID</span></code> separated by &#8221;,&#8221;.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">play_web_media</span></code> cannot be resumed. If it is paused by calling <code class="docutils literal"><span class="pre">pause</span></code>, then it just stops playing music, and cannot resume.</p>
</div>
<ul>
<li><p class="first">API: GET /api/v1/play_web_media_selected_speakers?SessionToken=&lt;session Token&gt;&amp;MediaUrl=&lt;URL of the song&gt;&amp;DeviceIDList=&lt;xxx,xxx,...&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Play a song from HTTP server to selected speakers, and then return true or false.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/play_web_media_selected_speakers?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F&amp;MediaUrl=http://seonman.github.io/music/hyolyn.mp3&amp;DeviceIDList=34317244381360,129321920968880
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This API call takes several hundreds millisecond to return the response.</p>
</div>
<ul>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
Command = &quot;play_web_media_selected_speakers&quot;,
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
MediaUrl = &quot;http://seonman.github.io/music/hyolyn.mp3&quot;
SesssionToken = &quot;PubNub-1000&quot;,
DeviceIDList = &quot;34317244381360,129321920968880&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;play_web_media_selected_speakers&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="play-tts-text-to-speech">
<h4>Play TTS (Text-to-Speech)<a class="headerlink" href="#play-tts-text-to-speech" title="Permalink to this headline">¶</a></h4>
<p>Plays a Text-to-Speech audio from VoiceRRS server. The Text to play is specified by <code class="docutils literal"><span class="pre">Text</span></code> parameter.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In order to use APIs for playing TTS (Text-To-Speech), you need to set VoiceRRS Application key on the setting menu of HKWHub App. You can go to the <a class="reference external" href="http://www.voicerss.org/">VoiceRRS</a> web site to get your application key.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">play_tts</span></code> does not specify speakers to play. It just uses the current session setting. If there is no speaker in the current session, then the play fails.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">play_tts</span></code> cannot be resumed. If it is paused by calling <code class="docutils literal"><span class="pre">pause</span></code>, then it just stops playing music, and cannot resume.</p>
</div>
<ul>
<li><p class="first">API: GET /api/v1/play_tts?SessionToken=&lt;session token&gt;&amp;Text=&lt;Text&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Play TTS audio, and then return true or false.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host_name&gt;/api/v1/play_tts?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F&amp;Text=&quot;Hello World. How are you today?&quot;
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This API call takes more than several hundreds millisecond to return the response, depending on the network condition.</p>
</div>
<ul>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
Command = &quot;play_tts&quot;,
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
Text = &quot;Hello World. How are you today?&quot;
SesssionToken = &quot;PubNub-1000&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;play_tts&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="play-tts-text-to-speech-as-party-mode">
<h4>Play TTS (Text-to-Speech) as party mode<a class="headerlink" href="#play-tts-text-to-speech-as-party-mode" title="Permalink to this headline">¶</a></h4>
<p>Plays a Text-to-Speech audio from VoiceRRS server with all speakers. The Text to play is specified by <code class="docutils literal"><span class="pre">Text</span></code> parameter.</p>
<ul>
<li><p class="first">API: GET /api/v1/play_tts_party_mode?SessionToken=&lt;session token&gt;&amp;Text=&lt;Text&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Play TTS audio to all speakers, and then return true or false.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/play_tts_party_mode?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F&amp;Text=&quot;Hello World. How are you today?&quot;
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This API call takes several hundreds millisecond to return the response.</p>
</div>
<ul>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
Command = &quot;play_tts_party_mode&quot;,
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
Text = &quot;Hello World. How are you today?&quot;
SesssionToken = &quot;PubNub-1000&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;play_tts_party_mode&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="id1">
<h4>Play a Song from Web Server with selected speakers<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>Plays a Text-to-Speech audio from VoiceRRS server with selected speakers. The Text to play is specified by <code class="docutils literal"><span class="pre">Text</span></code> parameter. The selected speakers are represented in <code class="docutils literal"><span class="pre">DeviceIDList</span></code> parameter as a list of <code class="docutils literal"><span class="pre">DeviceID</span></code> separated by &#8221;,&#8221;.</p>
<ul>
<li><p class="first">API: GET /api/v1/play_tts_selected_speakers?SessionToken=&lt;Session Token&gt;&amp;Text=&lt;Text&gt;&amp;DeviceIDList=&lt;xxx,xxx,...&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Play TTS from VoiceRSS server to selected speakers, and then return true or false.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/play_tts_selected_speakers?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F&amp;Text=&quot;Hello World. How are you today?&quot;&amp;DeviceIDList=34317244381360,129321920968880
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This API call takes several hundreds millisecond to return the response.</p>
</div>
<ul>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
Command = &quot;play_tts_selected_speakers&quot;,
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
Text = &quot;Hello World. How are you today?&quot;
SesssionToken = &quot;PubNub-1000&quot;,
DeviceIDList = &quot;34317244381360,129321920968880&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;play_tts_selected_speakers&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="pause-the-current-playback">
<h4>Pause the Current Playback<a class="headerlink" href="#pause-the-current-playback" title="Permalink to this headline">¶</a></h4>
<p>Pauses the current playback. The client can resue the playback by <code class="docutils literal"><span class="pre">resume_hub_media</span></code>.</p>
<ul>
<li><p class="first">API: GET /api/v1/pause_play?SessionToken=&lt;session token&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Pause the current playback, and then return true or false.</li>
<li>It can resume the current playback by calling <code class="docutils literal"><span class="pre">resume_hub_media</span></code> if and only if the playback is playing hub media. <code class="docutils literal"><span class="pre">play_web_media</span></code> cannot be resumed once it is paused or stopped.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/pause_play?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
Command = &quot;pause_play&quot;,
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SesssionToken = &quot;PubNub-1000&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;pause_play&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="resume-the-current-playback-with-hub-media">
<h4>Resume the Current Playback with Hub Media<a class="headerlink" href="#resume-the-current-playback-with-hub-media" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">API: GET /api/v1/resume_hub_media?SessionToken=&lt;session token&gt;&amp;PersistentID=&lt;persistent id&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Resume the current playback with Hub Media, and then return true or false.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/resume_hub_media?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F&amp;PersistentID=7387446959931482519
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
Command = &quot;resume_hub_media&quot;,
PersistentID = 7387446959931482519,
SesssionToken = &quot;PubNub-1000&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;resume_hub_media&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="resume-the-current-playback-with-hub-media-as-party-mode">
<h4>Resume the Current Playback with Hub Media as Party Mode<a class="headerlink" href="#resume-the-current-playback-with-hub-media-as-party-mode" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">API: GET /api/v1/resume_hub_media_party_mode?SessionToken=&lt;session token&gt;&amp;PersistentID=&lt;persistent id&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Resume the current playback with Hub Media with all speakers, and then return true or false.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/resume_hub_media_party_mode?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F&amp;PersistentID=7387446959931482519
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
Command = &quot;resume_hub_media_party_mode&quot;,
PersistentID = 7387446959931482519,
SesssionToken = &quot;PubNub-1000&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;resume_hub_media_party_mode&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="resume-the-current-playback-with-hub-media-with-selected-speakers">
<h4>Resume the Current Playback with Hub Media with selected speakers<a class="headerlink" href="#resume-the-current-playback-with-hub-media-with-selected-speakers" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">API: GET /api/v1/resume_hub_media_selected_speakers?SessionToken=&lt;session token&gt;&amp;PersistentID=&lt;persistent id&gt;&amp;DeviceIDList=&lt;xxx,xxx,...&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Resume the current playback with Hub Media with selected speakers, and then return true or false.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/resume_hub_media_selected_speakers?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F&amp;PersistentID=7387446959931482519&amp;DeviceIDList=34317244381360,129321920968880
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
Command = &quot;resume_hub_media_selected_speakers&quot;,
PersistentID = 7387446959931482519,
SesssionToken = &quot;PubNub-1000&quot;,
DeviceIDList = &quot;34317244381360,129321920968880&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;resume_hub_media_selected_speakers&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="stop-the-current-playback">
<h4>Stop the Current Playback<a class="headerlink" href="#stop-the-current-playback" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">API: GET /api/v1/stop_play?SessionToken=&lt;session token&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Stop the current playback with Hub Media, and then return true or false.</li>
<li>If the playback has stopped, then it cannot resume.</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">Example:</p>
<blockquote>
<div><ul class="simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/stop_play?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
Command = &quot;stop_play&quot;,
SesssionToken = &quot;PubNub-1000&quot;,
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;stop_play&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="get-the-playback-status-current-playback-state-and-elapsed-time">
<h4>Get the Playback Status (Current Playback State and Elapsed Time)<a class="headerlink" href="#get-the-playback-status-current-playback-state-and-elapsed-time" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">API: GET /api/v1/playback_status?SessionToken=&lt;session token&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last">
<li><p class="first">It returns the current state of the playback and also return the elapsed time (in second) of the playback.</p>
</li>
<li><p class="first">If it is not playing, then the elapsed time is (-1)</p>
</li>
<li><dl class="first docutils">
<dt>The following is the value of each playback state:</dt>
<dd><ul class="first last simple">
<li>PlayerStatePlaying : Now playing audio</li>
<li>PlayerStatePaused : Playing is paused. It can resume.</li>
<li>PlayerStateStopped : Playing is stopped. It cannot resume.</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">Note that if the playback has stopped, then it cannot resume.</p>
</li>
<li><p class="first">Developers need to check the playback status during the playback to handle any possible exceptional cases like interruption or errors. We recommedn to call this API every second.</p>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/playback_status?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;PlaybackState&quot;</span><span class="p">:</span><span class="s2">&quot;PlayerStatePlaying&quot;</span><span class="p">,</span>
 <span class="nt">&quot;TimeElapsed&quot;</span><span class="p">:</span><span class="s2">&quot;15&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>PubNub mode does not support playback_status command, because clients subscribing the channel will automatically receive the playback_status event from the HKWHub app when an event is available.</li>
<li>Event from HKWHub app</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
Envet = PlaybackTimeChanged,
PlaybackTime = 15
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="check-if-the-hub-is-playing-audio">
<h4>Check if the Hub is playing audio<a class="headerlink" href="#check-if-the-hub-is-playing-audio" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">API: GET /api/v1/is_playing?SessionToken=&lt;session token&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Returns true (playing) or false (not playing)</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/is_playing?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;IsPlaying&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
Command = &quot;is_playing&quot;,
SesssionToken = &quot;PubNub-1000&quot;,
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SessionToken = &quot;PubNub-1000&quot;,
ResponseOf = &quot;is_playing&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
</div>
<div class="section" id="volume-control">
<h3>Volume Control<a class="headerlink" href="#volume-control" title="Permalink to this headline">¶</a></h3>
<div class="section" id="get-volume-for-all-devices">
<h4>Get Volume for all Devices<a class="headerlink" href="#get-volume-for-all-devices" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">API: GET /api/v1/get_volume?SessionToken=&lt;session token&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Returns the average volume of all devices.</li>
<li>The range of volume is 0 (muted) to 50 (max)</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/get_volume?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Volume&quot;</span><span class="p">:</span><span class="s2">&quot;10&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
Command = &quot;get_volume&quot;,
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SesssionToken = &quot;PubNub-1000&quot;
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
ResponseOf = &quot;get_volume&quot;,
SesssionToken = &quot;PubNub-1000&quot;,
Volume = 10
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="get-volume-for-a-particular-device">
<h4>Get Volume for a particular device<a class="headerlink" href="#get-volume-for-a-particular-device" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">API: GET /api/v1/get_volume_device?SessionToken=&lt;session token&gt;&amp;DeviceID=&lt;device id&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Returns the  volume of a particular device</li>
<li>The range of volume is 0 (muted) to 50 (max)</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/get_volume_device?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F&amp;DeviceID=1234567
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Volume&quot;</span><span class="p">:</span><span class="s2">&quot;10&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
Command = &quot;get_volume_device&quot;,
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SesssionToken = &quot;PubNub-1000&quot;,
DeviceID=1234567
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
ResponseOf = &quot;get_volume_device&quot;,
SesssionToken = &quot;PubNub-1000&quot;,
Volume = 10
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="set-volume-for-all-devices">
<h4>Set Volume for all devices<a class="headerlink" href="#set-volume-for-all-devices" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">API: GET /api/v1/set_volume?SessionToken=&lt;session token&gt;&amp;Volume=&lt;volume&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Returns true or false</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/set_volume?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F&amp;Volume=10
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
Command = &quot;set_volume&quot;,
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SesssionToken = &quot;PubNub-1000&quot;,
Volume = 10
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
ResponseOf = &quot;set_volume&quot;,
SesssionToken = &quot;PubNub-1000&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="set-volume-for-a-particular-device">
<h4>Set Volume for a particular device<a class="headerlink" href="#set-volume-for-a-particular-device" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">API: GET /api/v1/set_volume_device?SessionToken=&lt;session token&gt;&amp;DeviceID=&lt;device id&gt;&amp;Volume=&lt;volume&gt;</p>
</li>
<li><dl class="first docutils">
<dt>Response</dt>
<dd><ul class="first last simple">
<li>Returns true or false</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Example:</dt>
<dd><ul class="first simple">
<li>Request:</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>http://&lt;server_host&gt;/api/v1/set_volume_device?SessionToken=r:abciKaTbUgdpQFuvYtgMm0F&amp;DeviceID=1234567&amp;Volume=10
</pre></div>
</div>
<ul class="simple">
<li>Response:</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre><span class="p">{</span><span class="nt">&quot;Result&quot;</span><span class="p">:</span><span class="s2">&quot;true&quot;</span><span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first simple">
<li>Publish Message</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre>{
Command = &quot;set_volume_device&quot;,
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
SesssionToken = &quot;PubNub-1000&quot;,
DeviceID = 1234567,
Volume = 10
}
</pre></div>
</div>
<ul class="simple">
<li>Message from HKWHub (via Subscribe)</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
ResponseOf = &quot;set_volume_device&quot;,
SesssionToken = &quot;PubNub-1000&quot;,
Result = true
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="device-status-change-event-only-available-for-pubnub-mode">
<h4>Device Status Change Event (only available for PubNub mode)<a class="headerlink" href="#device-status-change-event-only-available-for-pubnub-mode" title="Permalink to this headline">¶</a></h4>
<ul>
<li><dl class="first docutils">
<dt>PubNub</dt>
<dd><ul class="first">
<li><p class="first">Whenever a speaker status change occurs, the HKWHub sends DeviceStateUpdated event to subscribers.</p>
</li>
<li><dl class="first docutils">
<dt>Type of Reason</dt>
<dd><ul class="first last simple">
<li>NetworkUnavailable : the network became unavailable</li>
<li>DeviceAvailable : a device became available</li>
<li>DeviceUnavailable : a device becaome unavailable</li>
<li>DeviceError : some error occured to a particular speaker</li>
<li>SpeakerInfoUpdated: some of speaker information has been updated</li>
<li>WiFiSignalChanged: wifi signal has changed</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">Example:</p>
</li>
</ul>
<div class="last highlight-json"><div class="highlight"><pre>{
Event = DeviceStateUpdated,
HKWHubUUID = &quot;XXX-XXX-XXX-XXX&quot;,
Reason = SpeakerInfoUpdated,
SessionToken = &quot;PubNub-1000&quot;
}
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="id2">
<h2>OAuth2 Authorization API Specification<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id3">
<h3>Introduction<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>In order to access the HKIoTCloud REST APIs to control Omni speakers, your HKIoTCloud-enabled product needs to obtain a HKIoTCloud access token that grans access to the APIs on behalf of the product&#8217;s user.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please refer <a class="reference external" href="http://www.amazon.com/OAuth-2-0-Getting-Security-University/dp/1507800916/ref=tmm_pap_swatch_0?_encoding=UTF8&amp;qid=1454629444&amp;sr=8-1">OAuth 2.0 Getting Started in Web-API Security by Matthias Biehl</a> for your more understanding on OAuth2.</p>
</div>
<p>The workflow for obtaining and using an access token is as follows:</p>
<ol class="arabic simple">
<li>The user visits your product registration website and enters information about their specific instance of your product.</li>
<li>Your website creates a HKIoTCloud consent request using the user-supplied registration information and forwards the user to the HKIoTCloud website.</li>
<li>The user logs in to HKIoTCloud.</li>
<li>The user authorizes their instance of your product to be used with HKIoTCloud on their behalf.</li>
<li>HKIoTCloud returns an access token to your product registration website.</li>
<li>Your product registration website securely transfers the access token to the user&#8217;s specifi instance of your product.</li>
<li>The user&#8217;s speific instance of your product uses the access token to make HKIoTCloud API calls.</li>
</ol>
</div>
<div class="section" id="types-of-authorization">
<h3>Types of Authorization<a class="headerlink" href="#types-of-authorization" title="Permalink to this headline">¶</a></h3>
<p>HKIoTCloud supports two types of authorization:</p>
<ul class="simple">
<li>Authorization Code Grant - Send a client ID and a client secret to get an access token and a refresh token.</li>
<li>Password Grant - Send username and password along with client ID and client secret to get an access token and refresh token</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you are able to implement server-side scripting, then using authorization code grant is recommended. If you are not able to implement server-side scripting, then using password grant is your choice.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You must generate a new access token every hour, that is, expiration is set to 3,600 seconds. You can use refresh token in conjunction with your client ID and client secret to obtain a new access token without your user having to re-authenticate.</p>
</div>
</div>
<div class="section" id="using-the-password-grant-type">
<h3>Using the Password Grant Type<a class="headerlink" href="#using-the-password-grant-type" title="Permalink to this headline">¶</a></h3>
<p>To obtain an access token (and a refresh token) with password grant, you should <strong>POST</strong> to <code class="docutils literal"><span class="pre">/oauth/token</span></code>. You should include your client ID and client secret in the <code class="docutils literal"><span class="pre">Authorization</span></code> header by combining them with a colon &#8221;:&#8221; and then encoding in Base64. That is, <code class="docutils literal"><span class="pre">Base64(client_id:client_secret)</span></code>. And also, you should include <code class="docutils literal"><span class="pre">grant_type:</span> <span class="pre">password</span></code>, username and passworkd in the request body.</p>
<p><strong>Sample Request:</strong></p>
<div class="code highlight-python"><div class="highlight"><pre>POST /oauth/token HTTP/1.1
Host: hkiotcloud.herokuapp.com
Authorization: Basic RkZjUE9iS2h4OThvNXhtMzpjcENZQ1BrUjA4NXFSR3hFempDMUlGeEoxQWRhZFQ=
Content-Type: application/x-www-form-urlencoded

grant_type=password&amp;username=johndoe&amp;password=A3ddj3w
</pre></div>
</div>
<p>Here, <code class="docutils literal"><span class="pre">RkZjUE9iS2h4OThvNXhtMzpjcENZQ1BrUjA4NXFSR3hFempDMUlGeEoxQWRhZFQ=</span></code> is the result of Base64 encoding of clientId:clientSecret.</p>
<p><strong>Sample Response:</strong></p>
<div class="code highlight-python"><div class="highlight"><pre>HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
   &quot;access_token&quot;:&quot;62b8c11cfa0840b506230cb8af747230052775e1&quot;,
   &quot;token_type&quot;:&quot;bearer&quot;,
   &quot;expires_in&quot;:3600,
   &quot;refresh_token&quot;:&quot;7a7687b6b32247573b366d5bf2eeb707ba0a1b4d&quot;
 }
</pre></div>
</div>
</div>
<div class="section" id="creating-a-consent-request">
<h3>Creating a Consent Request<a class="headerlink" href="#creating-a-consent-request" title="Permalink to this headline">¶</a></h3>
<p>By creating a consent request, your user will be redirected to the HKIoTCloud website where they can enter their HKIoTCloud credentials in order to authorize their devices of your product to be used with the HKIoTCloud service.</p>
<p>The consent request is constructed as follows:</p>
<ul>
<li><dl class="first docutils">
<dt>Redirect the user to HKIoTCloud at <a class="reference external" href="https://hkiotcloud.herokuapp.com/oauth/token">https://hkiotcloud.herokuapp.com/oauth/token</a> with the following URL-encoded query parameters:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal"><span class="pre">client_id</span></code> : The client ID of your application. This information can be found on the HKIoTCloud website.</li>
<li><code class="docutils literal"><span class="pre">response_type</span></code>: <code class="docutils literal"><span class="pre">code</span></code> for authorization code grant.</li>
<li><code class="docutils literal"><span class="pre">redirect_uri</span></code> : Specifies the return URI that you added to your app&#8217;s  profile when signing up.</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p><strong>Sample Request:</strong></p>
<p>Send as GET request.</p>
<div class="highlight-json"><div class="highlight"><pre>https://hkiotcloud.herokuapp.com/oauth/authorize?response_type=code&amp;client_id=n7HhiTnKYjJd4zmM&amp;redirect_uri=https://your.app.com/oauthCallbackHKIoTCloud
</pre></div>
</div>
</div>
<div class="section" id="hkiotcloud-returns-a-response-to-your-registration-website">
<h3>HKIoTCloud Returns a Response to Your Registration Website<a class="headerlink" href="#hkiotcloud-returns-a-response-to-your-registration-website" title="Permalink to this headline">¶</a></h3>
<p>After the user is authenticated, the user is redirected to the URI that you provided in the <code class="docutils literal"><span class="pre">redirect_uri</span></code> parameter of the request.</p>
<p>The response includes an authorization code.</p>
<p><strong>Sample Authorizatino Code Grant Response:</strong></p>
<div class="highlight-json"><div class="highlight"><pre>https://your.app.com/oauthCallbackHKIoTCloud?code=0b368d49809048dd7424d6f7fd869a98f2372859
</pre></div>
</div>
<p>Next, your service leverages the returned authorization code to ask for an access token:</p>
<ul class="simple">
<li>Send a <strong>POST</strong> request to <a class="reference external" href="https://hkiotcloud.herokuapp.com/oauth/token">https://hkiotcloud.herokuapp.com/oauth/token</a> with the following parameters:</li>
</ul>
<p><strong>HTTP Header Parameters:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Content-Type:</span> <span class="pre">application/x-www-form-urlencoded</span></code></li>
</ul>
<p><strong>HTTP Body Parameters:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">grant_type:</span> <span class="pre">authorization_code</span></code></li>
<li><code class="docutils literal"><span class="pre">code</span></code> : The authorization code that was returned in the response.</li>
<li><code class="docutils literal"><span class="pre">client_id</span></code> : Your application&#8217;s client ID. This information can be found on the HKIoTCloud website.</li>
<li><code class="docutils literal"><span class="pre">client_secret</span></code> : The application&#8217;s client secret. This information can be found on the HKIoTCloud website.</li>
<li><code class="docutils literal"><span class="pre">redirect_uri</span></code> : The return URI that you added to your app&#8217;s profile when signing up.</li>
</ul>
<p><strong>Sample Request:</strong></p>
<div class="highlight-json"><div class="highlight"><pre>POST /oauth/token HTTP/1.1
Host: hkiotcloud.herokuapp.com
Content-Type: application/x-www-form-urlencoded
Cache-Control: no-cache

grant_type=authorization_code&amp;code=2b3711911f4f2263e785eeda386046ccc8da6aee&amp;client_id=n7HhiTnKYjJd4zmM&amp;client_secret=ANRfB9z94xtcxFGXrd5XHXEiKg43UY&amp;redirect_uri=https://hkvoicecloud.herokuapp.com/oauthCallbackHKIoTCloud
</pre></div>
</div>
<p><strong>Sample Response:</strong></p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span>
        <span class="nt">&quot;access_token&quot;</span><span class="p">:</span> <span class="s2">&quot;902da699ed1d5d511bd750366889f3260c2015b4&quot;</span><span class="p">,</span>
        <span class="nt">&quot;expires_in&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
        <span class="nt">&quot;refresh_token&quot;</span><span class="p">:</span> <span class="s2">&quot;5defcb0a9a49ac9b2403b8c78600638238d81011&quot;</span><span class="p">,</span>
        <span class="nt">&quot;token_type&quot;</span><span class="p">:</span> <span class="s2">&quot;bearer&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Transfer the access and refresh tokens to the user&#8217;s product.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Currently, a refresh token is valid for one year, while an access token is valid only an hour and an authorization code is valid only a minute.</p>
</div>
</div>
<div class="section" id="using-the-access-token-to-make-hkiotcloud-api-calls">
<h3>Using the Access Token to Make HKIoTCloud API Calls<a class="headerlink" href="#using-the-access-token-to-make-hkiotcloud-api-calls" title="Permalink to this headline">¶</a></h3>
<p>When you call the HKIoTCloud API calls, pass the value of the access token into the request header. Specifically, create an <code class="docutils literal"><span class="pre">Authorization</span></code> header and give it the value <code class="docutils literal"><span class="pre">Bearer</span> <span class="pre">&lt;access</span> <span class="pre">token&gt;</span></code>.</p>
<p><strong>Sample Request using curl:</strong></p>
<ul class="simple">
<li>curl -X GET -H &#8220;Authorization: Bearer 15c0507f3a550d7a31f7af5dc45e4dd9fd9f4bc8&#8221; <a class="reference external" href="http://hkiotcloud.herokuapp.com/api/v1/init_session">http://hkiotcloud.herokuapp.com/api/v1/init_session</a></li>
</ul>
</div>
<div class="section" id="getting-a-new-access-token-with-refresh-token">
<h3>Getting a New Access Token with Refresh Token<a class="headerlink" href="#getting-a-new-access-token-with-refresh-token" title="Permalink to this headline">¶</a></h3>
<p>The access token is valid for one hour. When the access token expires or is about to expire, you can exchange the refresh token for new access and refresh tokens.</p>
<ul class="simple">
<li>Send a <code class="docutils literal"><span class="pre">POST</span></code> request to <code class="docutils literal"><span class="pre">https://hkiotcloud.herokuapp.com/oauth/token</span></code> with the following parameters:</li>
</ul>
<p><strong>HTTP Header Parameters:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Content-Type:</span> <span class="pre">application/x-www-form-urlencoded</span></code></li>
</ul>
<p><strong>HTTP Body Parameters:</strong></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">grant_type:</span> <span class="pre">refresh_token</span></code></li>
<li><code class="docutils literal"><span class="pre">refresh_token</span></code> : The refresh token returned with the last request for a new access token.</li>
<li><code class="docutils literal"><span class="pre">client_id</span></code> : Your application&#8217;s client ID. This information can be found on the HKIoTCloud website.</li>
<li><code class="docutils literal"><span class="pre">client_secret</span></code> : The application&#8217;s client secret. This information can be found on the HKIoTCloud website.</li>
</ul>
<p><strong>Sample Request:</strong></p>
<div class="highlight-json"><div class="highlight"><pre>POST /oauth/token HTTP/1.1
Host: hkiotcloud.herukuapp.com
Content-Type: application/x-www-form-urlencoded
Cache-Control: no-cache

grant_type=refresh_token&amp;refresh_token=5defcb0a9a49ac9b2403b8c78600638238d81011&amp;client_id=n7HhiTnKYjJd4zmM&amp;client_secret=ANRfB9z94xtcxFGXrd5XHXEiKg43UY
</pre></div>
</div>
<p><strong>Sample Response:</strong></p>
<div class="highlight-json"><div class="highlight"><pre>HTTP/1.1 200 OK

{
        &quot;access_token&quot;: &quot;90da03bdceb15cf75d99ff99715ce87b29602651&quot;,
        &quot;expires_in&quot;: 3600,
        &quot;refresh_token&quot;: &quot;6a762dfce9146dbf149f881c5aa15fc6cfdf1fd0&quot;,
        &quot;token_type&quot;: &quot;bearer&quot;
}
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/HarmanDeveloperLogo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction</a><ul>
<li><a class="reference internal" href="#overview-of-hwkhub">Overview of HWKHub</a><ul>
<li><a class="reference internal" href="#use-cases">Use Cases</a></li>
<li><a class="reference internal" href="#hkwhub-app">HKWHub App</a><ul>
<li><a class="reference internal" href="#features">Features</a></li>
<li><a class="reference internal" href="#usage">Usage</a></li>
</ul>
</li>
<li><a class="reference internal" href="#overall-architecture">Overall Architecture</a></li>
</ul>
</li>
<li><a class="reference internal" href="#quick-getting-started-guide-to-hkwhub-app">Quick Getting Started Guide to HKWHub App</a><ul>
<li><a class="reference internal" href="#overview-of-hkwhubapp">Overview of HKWHubApp</a><ul>
<li><a class="reference internal" href="#main-screen">Main Screen</a></li>
</ul>
</li>
<li><a class="reference internal" href="#hkiotcloud-mode">HKIoTCloud Mode</a><ul>
<li><a class="reference internal" href="#connecting-to-hkiotcloud">Connecting to HKIoTCloud</a></li>
<li><a class="reference internal" href="#sending-rest-requests-to-hkiotcloud">Sending REST Requests to HKIoTCloud</a></li>
</ul>
</li>
<li><a class="reference internal" href="#local-server-mode">Local Server Mode</a><ul>
<li><a class="reference internal" href="#running-local-server">Running Local Server</a></li>
<li><a class="reference internal" href="#sending-rest-requests-to-localserver">Sending REST Requests to LocalServer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pubnub-server-mode">PubNub Server Mode</a><ul>
<li><a class="reference internal" href="#connect-to-pubnub-server">Connect to PubNub Server</a></li>
<li><a class="reference internal" href="#sending-rest-requests-to-pubnub-cloud">Sending REST Requests to PubNub Cloud</a></li>
<li><a class="reference internal" href="#sample-web-app">Sample Web App</a></li>
</ul>
</li>
<li><a class="reference internal" href="#use-curl-command-to-send-rest-requests">Use <code class="docutils literal"><span class="pre">curl</span></code> command to send REST requests</a><ul>
<li><a class="reference internal" href="#get-an-access-token-and-refresh-token-hkiotcloud-mode-only">Get an Access Token and Refresh Token (HKIoTCloud mode only)</a></li>
<li><a class="reference internal" href="#a-init-session">a. Init session</a></li>
<li><a class="reference internal" href="#b-add-alls-speaker-to-session">b. Add alls speaker to session</a></li>
<li><a class="reference internal" href="#c-get-the-list-of-speakers-available">c. Get the list of speakers available</a></li>
<li><a class="reference internal" href="#d-add-a-speaker-to-session">d. Add a speaker to session</a></li>
<li><a class="reference internal" href="#e-get-the-media-list">e. Get the media list</a></li>
<li><a class="reference internal" href="#f-play-a-media-item-listed-in-the-hkwhub-app">f. Play a media item listed in the HKWHub app</a></li>
<li><a class="reference internal" href="#f-play-a-media-item-in-the-hkwhub-by-specifying-a-speaker-list-to-play">f. Play a media item in the HKWHub by specifying a speaker list to play</a></li>
<li><a class="reference internal" href="#g-play-a-http-streaming-media-as-party-mode">g. Play a HTTP streaming media as party mode</a></li>
<li><a class="reference internal" href="#h-stop-playing">h. Stop playing</a></li>
<li><a class="reference internal" href="#i-set-volume">i. Set Volume</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#playback-session-management">Playback Session Management</a><ul>
<li><a class="reference internal" href="#playback-session-creation">Playback Session Creation</a></li>
<li><a class="reference internal" href="#priority-of-session">Priority of Session</a></li>
<li><a class="reference internal" href="#session-timeout">Session Timeout</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rest-api-specification-including-pubnub-json-format">REST API Specification (including PubNub JSON format)</a><ul>
<li><a class="reference internal" href="#session-management">Session Management</a><ul>
<li><a class="reference internal" href="#start-session">Start Session</a></li>
<li><a class="reference internal" href="#close-session">Close Session</a></li>
</ul>
</li>
<li><a class="reference internal" href="#device-management">Device Management</a><ul>
<li><a class="reference internal" href="#get-the-device-count">Get the device count</a></li>
<li><a class="reference internal" href="#get-the-list-of-devices-and-their-information">Get the list of devices and their information</a></li>
<li><a class="reference internal" href="#get-the-device-information">Get the Device Information</a></li>
<li><a class="reference internal" href="#add-a-device-to-session">Add a Device to Session</a></li>
<li><a class="reference internal" href="#remove-a-device-from-session">Remove a Device from Session</a></li>
<li><a class="reference internal" href="#set-party-mode">Set party mode</a></li>
</ul>
</li>
<li><a class="reference internal" href="#media-playback-management">Media Playback Management</a><ul>
<li><a class="reference internal" href="#get-the-list-of-media-item-in-the-media-list-of-the-hkwhub-app">Get the list of media item in the Media List of the HKWHub app</a></li>
<li><a class="reference internal" href="#play-a-song-in-the-media-list-of-the-hkwhub-app">Play a song in the Media List of the HKWHub app</a></li>
<li><a class="reference internal" href="#play-a-song-in-the-media-list-as-party-mode">Play a song in the Media list as party mode</a></li>
<li><a class="reference internal" href="#play-a-song-in-the-media-list-with-selected-speakers">Play a song in the Media list with selected speakers</a></li>
<li><a class="reference internal" href="#play-a-song-from-web-server">Play a Song from Web Server</a></li>
<li><a class="reference internal" href="#play-a-song-from-web-server-as-party-mode">Play a Song from Web Server as party mode</a></li>
<li><a class="reference internal" href="#play-a-song-from-web-server-with-selected-speakers">Play a Song from Web Server with selected speakers</a></li>
<li><a class="reference internal" href="#play-tts-text-to-speech">Play TTS (Text-to-Speech)</a></li>
<li><a class="reference internal" href="#play-tts-text-to-speech-as-party-mode">Play TTS (Text-to-Speech) as party mode</a></li>
<li><a class="reference internal" href="#id1">Play a Song from Web Server with selected speakers</a></li>
<li><a class="reference internal" href="#pause-the-current-playback">Pause the Current Playback</a></li>
<li><a class="reference internal" href="#resume-the-current-playback-with-hub-media">Resume the Current Playback with Hub Media</a></li>
<li><a class="reference internal" href="#resume-the-current-playback-with-hub-media-as-party-mode">Resume the Current Playback with Hub Media as Party Mode</a></li>
<li><a class="reference internal" href="#resume-the-current-playback-with-hub-media-with-selected-speakers">Resume the Current Playback with Hub Media with selected speakers</a></li>
<li><a class="reference internal" href="#stop-the-current-playback">Stop the Current Playback</a></li>
<li><a class="reference internal" href="#get-the-playback-status-current-playback-state-and-elapsed-time">Get the Playback Status (Current Playback State and Elapsed Time)</a></li>
<li><a class="reference internal" href="#check-if-the-hub-is-playing-audio">Check if the Hub is playing audio</a></li>
</ul>
</li>
<li><a class="reference internal" href="#volume-control">Volume Control</a><ul>
<li><a class="reference internal" href="#get-volume-for-all-devices">Get Volume for all Devices</a></li>
<li><a class="reference internal" href="#get-volume-for-a-particular-device">Get Volume for a particular device</a></li>
<li><a class="reference internal" href="#set-volume-for-all-devices">Set Volume for all devices</a></li>
<li><a class="reference internal" href="#set-volume-for-a-particular-device">Set Volume for a particular device</a></li>
<li><a class="reference internal" href="#device-status-change-event-only-available-for-pubnub-mode">Device Status Change Event (only available for PubNub mode)</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id2">OAuth2 Authorization API Specification</a><ul>
<li><a class="reference internal" href="#id3">Introduction</a></li>
<li><a class="reference internal" href="#types-of-authorization">Types of Authorization</a></li>
<li><a class="reference internal" href="#using-the-password-grant-type">Using the Password Grant Type</a></li>
<li><a class="reference internal" href="#creating-a-consent-request">Creating a Consent Request</a></li>
<li><a class="reference internal" href="#hkiotcloud-returns-a-response-to-your-registration-website">HKIoTCloud Returns a Response to Your Registration Website</a></li>
<li><a class="reference internal" href="#using-the-access-token-to-make-hkiotcloud-api-calls">Using the Access Token to Make HKIoTCloud API Calls</a></li>
<li><a class="reference internal" href="#getting-a-new-access-token-with-refresh-token">Getting a New Access Token with Refresh Token</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Harman HKWirelessHD API Documentation</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/introduction.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="index.html" title="Harman HKWirelessHD API Documentation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Harman Developer 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Harman International.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>